<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Css/bootstrap-responsive.css" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Css/style.css" />
	<link rel="stylesheet" type="text/css" href="__PUBLIC__/Css/jquery-ui.css" />
    <script type="text/javascript" src="__PUBLIC__/Js/jquery.js"></script>
    <script type="text/javascript" src="__PUBLIC__/Js/bootstrap.js"></script>
    <script type="text/javascript" src="__PUBLIC__/Js/ckform.js"></script>
    <script type="text/javascript" src="__PUBLIC__/Js/common.js"></script>
	<script type="text/javascript" src="__PUBLIC__/Js/jquery-ui-datepicker.js"></script>
    <style type="text/css">
        body {
            padding-bottom: 40px;
        }
        .sidebar-nav {
            padding: 9px 0;
        }

        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }
         #remind{  -moz-border-bottom-colors: none;-moz-border-left-colors: none;-moz-border-right-colors: none;-moz-border-top-colors: none;background: #fff none repeat scroll 0 0;border-color: -moz-use-text-color #a7a6aa #a7a6aa;border-image: none;border-style: none solid solid;border-width: 0 1px 1px;display: none;float: right;height: 180px;overflow-y: scroll;position: absolute;width: 207px;margin-top: -10px;list-style: none;z-index: 1000;}
    #key{margin:0;}
    #remind #key li:hover{background-color:#ccc;cursor: pointer;}
    </style>
</head>
<body>
<div class="dv">
<form action="" method="post" class="definewidth m20" id="form1">
<input type="hidden" name="quanid" value="{$list.quanid}"/>
    <input type="hidden" name="utype" value="{$list.utype}"/>
    <input type="hidden" name="vtype" value="{$list.vtype}"/>
<table class="table table-bordered table-hover ">
    <tr>
        <td width="10%" class="tableleft">营销产品编号</td>
        <td>{$list.quanid}</td>
    </tr>
	<tr>
        <td width="10%" class="tableleft">营销产品名称</td>
        <td><input type="text" name="quanname" value="{$list.quanname}" id="quanname"/></td>
    </tr>
    <tr>
        <td width="10%" class="tableleft">劵类型&nbsp;<span style="color:#ff0700;">*</span></td>
        <td>
            <if condition="$list.vtype eq 1">活动劵<else/>普通劵</if>
        </td>
    </tr>
    <if condition="$list.vtype eq 1">
        <tr>
            <td width="10%" class="tableleft">开始时间</td>
            <td><input type="text" name="startdate" id="startdate" value="{$list.startdate}"/></td>
        </tr>
        <tr>
            <td width="10%" class="tableleft">结束时间</td>
            <td><input type="text" name="enddate" id="enddate" value="{$list.enddate}"/></td>
        </tr>
        <else/>
        <tr>
            <td width="10%" class="tableleft">有效期(月) </td>
            <td><input type="text" name="validaty" id="validate" value="{$list.validaty}" onkeyup="intOnly(this);"/></td>
        </tr>
    </if>

    <if condition="$is_admin eq 1">
        <tr>
            <td width="10%" class="tableleft">劵适用类型&nbsp;<span style="color:#ff0700;">*</span></td>
            <td>
                <if condition="$list.utype eq 1">通用劵<else/>专用劵</if>
            </td>
        </tr>
        <if condition="$list.utype eq 2">
            <tr>
                <td width="10%" class="tableleft">发卡机构/商户</td>
                <td>{$list.pname}</td>
            </tr>
        </if>
    </if>
    <tr>
        <td width="10%" class="tableleft">劵所属品类&nbsp;<span style="color:#ff0700;">*</span></td>
        <td>
            <select name="cate">
                <option value="-1">请选择劵品类</option>
                <option value="1" <if condition="$list.cate eq 1">selected</if>>住宿</option>
                <option value="2" <if condition="$list.cate eq 2">selected</if>>餐饮</option>
                <option value="3" <if condition="$list.cate eq 3">selected</if>>饼屋</option>
                <option value="4" <if condition="$list.cate eq 4">selected</if>>烧烤</option>
                <option value="5" <if condition="$list.cate eq 5">selected</if>>电影</option>
                <option value="6" <if condition="$list.cate eq 6">selected</if>>活动</option>
                <option value="8" <if condition="$list.cate eq 8">selected</if>>花卉</option>
                <option value="9" <if condition="$list.cate eq 9">selected</if>>教育</option>
                <option value="9" <if condition="$list.cate eq 10">selected</if>>健身房</option>
                <option value="9" <if condition="$list.cate eq 11">selected</if>>洗衣房</option>
                <option value="7" <if condition="$list.cate eq 7">selected</if>>其他</option>
            </select>
        </td>
    </tr>
	<tr>
        <td width="10%" class="tableleft">产品价格（元）</td>
        <td><input type="text" name="amount" value="{$list.amount}" id="amount" onkeyup="clearNoNum(this);"/></td>
    </tr>
    <tr>
        <td width="10%" class="tableleft">是否转让</td>
        <td>
            <label style="display: inline;"><input type="radio" name="transfer" value="1" <if condition="$list.transfer eq 1">checked</if>/>是</label>
            <label style="display: inline;"><input type="radio" name="transfer" value="2" <if condition="$list.transfer eq 2">checked</if>/>否</label>
        </td>
    </tr>
    <tr>
        <td width="10%" class="tableleft">排序</td>
        <td><input type="text" name="sort" value="{$list.sort}" /></td>
    </tr>
    <tr>
        <td class="tableleft">备注</td>
        <td ><input type="text" name="memo" value="{$list.memo}"/></td>
    </tr>
    <tr>
        <td class="tableleft"></td>
        <td>
            <button type="submit"  class="btn btn-primary" >保存</button> &nbsp;&nbsp;<button type="button" class="btn btn-success" name="backid" id="backid" onclick="window.location.href='__URL__/product'">返回列表</button>
        </td>
    </tr>
</table>
</form>
    </div>
</body>
<script type="text/javascript">
    $(function(){
        $('#startdate').datepicker();
        $('#enddate').datepicker();
        $("#ui-datepicker-div").hide();
         $(document).click(function(){
            $("#remind").css("display","none");
        });
        $("#form1").submit(function(){
            var quanname=$.trim($("#quanname").val());
            var panterid=$.trim($("#panterid").val());
            var amount=$.trim($("#amount").val());
            if(quanname==''){
                alert("营销产品名称不能为空");
                return false;
            }
//            if(panterid==''){
//                alert("发卡机构/商户不能为空");
//                return false;
//            }
            if(amount==''){
                alert("产品价格不能为空");
                return false;
            }
            var m=/(^0\.\d{1,2}$)|(^[1-9]\d*\.\d{1,2}$)|(^[1-9]\d*$)/;
            var bool=m.test(amount);
            if(!bool){
              alert('金额最多可以精确到分!');
              return false;
            }
        });
    })
    function intOnly(obj){
        obj.value=obj.value.replace(/[^\d.]/g,'');
    }
function autoComplete(value){
        $.ajax({
            type:'GET',
            url:'{:U("Common/getComplete")}',
            data:{keys:value},
            dataType:'json',
            success:function(data){
                $('#remind').find('ul').html('');
                 if(typeof(data)=='object'){
                     var childObj='';
                     for(var i=0;i<data.length;i++){
                         childObj+='<li style="list-style:none;" onclick="addVal(this,'+"'keys'"+',\''+data[i].panterid+'\')">'+data[i].pname+'</li>';
                     }
                     $('#remind').css('display','block');
                     $('#remind').find('ul').append(childObj);
                     if($('#remind').find('ul').height()<180){
                         var height=$('#remind').find('ul').height();
                         $('#remind').height(height);
                     }else{
                         $('#remind').height(180);
                     }
                }else{
                    $('#remind').css('display','none');

                }
            }
        })
    }
function addVal(a,id,pid){
    var value=$(a).text();
    $('#'+id).siblings('input').val(pid);
    $('#'+id).val(value);
    $(a).parent().parent().css('display','none')
}
    </script>
</html>
